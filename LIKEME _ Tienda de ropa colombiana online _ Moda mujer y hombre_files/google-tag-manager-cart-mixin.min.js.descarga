define(['jquery','mage/translate','Magento_Customer/js/customer-data','Lineadirecta_GoogleTagManager/js/model/google-tag-manager-data-resolver','jquery-ui-modules/widget'],function($,$t,customerData,googleTagManagerDataResolver){'use strict';var initActionsMixin={_create:function(){this._super();this.googleAnalyticsUniversalCart.loggedInFromCookies();this.googleAnalyticsUniversalCart.forgotPasswordFromCookies();this.googleAnalyticsUniversalCart.createAccountFromCookies();this.googleAnalyticsUniversalCart.layeredNavigation();this.googleAnalyticsUniversalCart.searchResult();this.googleAnalyticsUniversalCart.couponCodesHandler();this.googleAnalyticsUniversalCart.newsletterSubscribeHandler();this.googleAnalyticsUniversalCart.socialClickHandler();},_executeEvents:function(){var product;this.options.temporaryEventStorage.forEach(function(item,index){if(typeof item.productInfo==='undefined'){return;}
item.productInfo.forEach(function(productInfoItem){product=this.getProduct(productInfoItem);product.qty=productInfoItem.qty||product.qty;if(!_.isUndefined(product['product_sku'])&&parseInt(product.qty,10)>0){this.options.actions[item.type](product);}
this.options.temporaryEventStorage.splice(index,1);}.bind(this));}.bind(this));},_initActions:function(){var self=this,events=this.options.events,customer=customerData.get('customer')();this.options.actions[events.AJAX_ADD_TO_CART]=function(product){this.googleAnalyticsUniversal.addToCart(product,googleTagManagerDataResolver.prepareItemData(product),googleTagManagerDataResolver.getUserId());}.bind(this);this.options.actions[events.AJAX_REMOVE_FROM_CART]=function(product){var item=googleTagManagerDataResolver.prepareItemData(product);item['quantity']=product.qty;this.googleAnalyticsUniversal.removeFromCart(product,item,googleTagManagerDataResolver.getUserId());}.bind(this);}};return function(targetWidget){$.widget('mage.gtmCart',targetWidget,initActionsMixin);return $.mage.gtmCart;};});